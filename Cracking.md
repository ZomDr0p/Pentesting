# HASHCAT
##### Hashcat is the world's fastest and most advanced password recovery tool.


## Windows - Dictionary Attack

To crack the Windows hashes we will take this example of a dumped hash from a Windows 2003 machine using HASHDUMP. Note that these hashes are in NTLM format so keep in mind that Hashcat has to use this module. 

NTLM hash in the format <User name>:<User ID>:<LM hash>:<NT hash>:<Comment>:<Home Dir>:

```

root@kali20203:/home/user/Desktop# cat windows2003_hashdump_ouput.txt
Administrador:500:e52cac67419a9a224a3b108f3fa6cb6d:8846f7eaee8fb117ad06bdd830b7586c:::
usuariobasico:1125:5c56109436004859ebd85531b8d5539f:1bfd3d3e4d9b85290d000fe25714b487:::

```

We are going to execute the following command with these arguments in order to crack the passwords

- -m 1000 --> The type of module to be used in this case will be NTLM
- -a 0 --> dictionary  method, we have to point out the dictionary we are going to use
- -o output_crack.txt --> the output file of cracked NTLM hashes
- windows2003_hashdump_ouput.txt --> NTLM hashes dumped with HASHDUMP 
- /usr/share/wordlists/personalizada.txt --> the dictionary used which will be words in plain text


```

root@kali20203:/home/user/Desktop# hashcat -m 1000 -a 0 -o output_windowsxpcrack.txt windowsxphashes.txt /usr/share/wordlists/personalizada.txt

```

## Linux - Dictionary Attack

For Linux hashes we will take this example cracked hashes from a Metasploitable machine.

- https://information.rapid7.com/download-metasploitable-2017.html

This article explains Linux passwords very well, better than me

- https://www.slashroot.in/how-are-passwords-stored-linux-understanding-hashing-shadow-utils

We need to understand a little bit the format of the Linux hashes

- The first field is the username
- The dollar symbol means the type of hash it is
   - $1 = MD5 hashing algorithm
   - $2 =Blowfish Algorithm is in use
   - $2a=eksblowfish Algorithm
   - $5 =SHA-256 Algorithm
   - $6 =SHA-512 Algorithm
- The second block is SALT value
- The third block is the hash value of salt+user password 
- The the fourth and fifth blocks belongs to the user identifier and group identifier
- The sixth block is just a comment
- The seventh block is the home directory
- The eighth block is for command shell

See the following example:

| Username | Type of Hash |  SALT | HASHSALT+PASSWORD | UID | GID | Comment | Home directory | Shell |
| ------------- | ------------- | ------------- | ------------- | ------------- | ------------- | ------------- | ------------- | ------------- |
|  user | $1$  | HESu9xrH | k.o3G93DGoXIiQKkPmUgZ | 1001 | 1001 | just a user,111,, | /home/user | /bin/bash |

This is the hashes we are going to try to crack

```

root@kali20203:/home/user/Desktop# cat metasploitable_hashdump_ouput.txt
root:$1$/avpfBJ1$x0z8w5UF9Iv./DR9E9Lid.:0:0:root:/root:/bin/bash
user:$1$HESu9xrH$k.o3G93DGoXIiQKkPmUgZ0:1001:1001:just a user,111,,:/home/user:/bin/bash
sys:$1$fUX6BPOt$Miyc3UpOzQJqz4s5wFD9l0:3:3:sys:/dev:/bin/sh
klog:$1$f2ZVMS4K$R9XkI.CmLdHhdUE3X9jqP0:103:104::/home/klog:/bin/false
msfadmin:$1$XN10Zj2c$Rt/zzCW3mLtUWA.ihZjA5/:1000:1000:msfadmin,,,:/home/msfadmin:/bin/bash
postgres:$1$Rw35ik.x$MgQgZUuO5pAoUvfJhfcYe/:108:117:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
service:$1$kR3ue7JZ$7GxELDupr5Ohp6cjZ3Bu//:1002:1002:,,,:/home/service:/bin/bash

```

We need to prepare this dump file so it is in a format that can understand hashcat. We need to remove every field except the Type of Hash, SALT and HASHSALT+PASSWORD. 

```

root@kali20203:/home/user/Desktop# cat metasploitable_hashdump_prepared.txt
$1$/avpfBJ1$x0z8w5UF9Iv./DR9E9Lid.
$1$fUX6BPOt$Miyc3UpOzQJqz4s5wFD9l0
$1$f2ZVMS4K$R9XkI.CmLdHhdUE3X9jqP0
$1$XN10Zj2c$Rt/zzCW3mLtUWA.ihZjA5/
$1$Rw35ik.x$MgQgZUuO5pAoUvfJhfcYe/
$1$HESu9xrH$k.o3G93DGoXIiQKkPmUgZ0
$1$kR3ue7JZ$7GxELDupr5Ohp6cjZ3Bu//

```

We are going to execute the following command with these arguments in order to crack the passwords

 - m 500 --> The module type to be used in this case will be md5crypt, a UNIX MD5
 - -a 0 --> dictionary  method, we have to point out the dictionary we are going to use
 - output_metasploitable.txt --> the output file of the cracked MD5 hashes, the MD5 will appear and behind it, the password in plain text
 - metasploitable_hashdump_prepared.txt --> Hash md5crypt in the format $typehash$salt$hashsalt+password$
 - /usr/share/wordlists/personalizada.txt --> the dictionary used which will be plain text words, all related to metasploitable

```

root@kali20203:/home/user/Desktop# hashcat -m 500 -a 0 -o output_metasploitable.txt metasploitable_hashdump_prepared.txt /usr/share/wordlists/personalizada.txt

```
